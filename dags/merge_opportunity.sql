 MERGE `searce-dna-ps1-delivery.salesforce_curated.opportunity` AS target
USING `searce-dna-ps1-delivery.salesforce_raw.raw_opportunity` AS source
ON target.id = source.id
WHEN MATCHED AND source.SystemModstamp > target.SystemModstamp THEN
  UPDATE SET
target.Id = source.Id,
target.AC_Most_Recent_Closed_Won_Start_Date__c = source.AC_Most_Recent_Closed_Won_Start_Date__c,
target.AC_Most_Recent_Won_Term_Length__c = source.AC_Most_Recent_Won_Term_Length__c,
target.AMS_Marquee_Account__c = source.AMS_Marquee_Account__c,
target.AM_Locations__c = source.AM_Locations__c,
target.Access_to_Locations__c = source.Access_to_Locations__c,
target.AccountId = source.AccountId,
target.Account_No_of_Opps__c = source.Account_No_of_Opps__c,
target.Account_Owner__c = source.Account_Owner__c,
target.Account_Platform_ID__c = source.Account_Platform_ID__c,
target.Active_Agreement__c = source.Active_Agreement__c,
target.Address__c = source.Address__c,
target.Agreement_Type__c = source.Agreement_Type__c,
target.Amount = source.Amount,
target.Annual_Spend_Not_to_Exceed__c = source.Annual_Spend_Not_to_Exceed__c,
target.Approval_Status__c = source.Approval_Status__c,
target.Automatic_Renewal__c = source.Automatic_Renewal__c,
target.Brand__c = source.Brand__c,
target.Budget_Confirmed__c = source.Budget_Confirmed__c,
target.CloseDate = source.CloseDate,
target.Close_Won_Month__c = source.Close_Won_Month__c,
target.Close_Won_Year__c = source.Close_Won_Year__c,
target.ClosedAmount__c = source.ClosedAmount__c,
target.Collection_Notes__c = source.Collection_Notes__c,
target.Collection_Owner__c = source.Collection_Owner__c,
target.Commission_Disposition__c = source.Commission_Disposition__c,
target.Commission_Notes__c = source.Commission_Notes__c,
target.Commission_Pay_Cycle__c = source.Commission_Pay_Cycle__c,
target.Consumption_Model_Numeric__c = source.Consumption_Model_Numeric__c,
target.Consumption_Model__c = source.Consumption_Model__c,
target.ContactId = source.ContactId,
target.Contact_Method__c = source.Contact_Method__c,
target.Contact__c = source.Contact__c,
target.Contract_End_Date__c = source.Contract_End_Date__c,
target.Contract_Expires_Integer__c = source.Contract_Expires_Integer__c,
target.Contract_Start_Date__c = source.Contract_Start_Date__c,
target.Contract_Start_End_Date_Convert_to_Text__c = source.Contract_Start_End_Date_Convert_to_Text__c,
target.Contract_Start_Year_Quarter__c = source.Contract_Start_Year_Quarter__c,
target.CreatedById = source.CreatedById,
target.CreatedDate = source.CreatedDate,
target.Customer_PO_Reference__c = source.Customer_PO_Reference__c,
target.Deal_Size__c = source.Deal_Size__c,
target.Description = source.Description,
target.Discount__c = source.Discount__c,
target.Discovery_Completed__c = source.Discovery_Completed__c,
target.Do_Not_Create_Renewal_Opp__c = source.Do_Not_Create_Renewal_Opp__c,
target.End_Date__c = source.End_Date__c,
target.End_Date_and_Time__c = source.End_Date_and_Time__c,
target.Executive_approval_required__c = source.Executive_approval_required__c,
target.Expected_Quarterly_Revenue__c = source.Expected_Quarterly_Revenue__c,
target.Expiration_of_Brick__c = source.Expiration_of_Brick__c,
target.ExtAccountCode__c = source.ExtAccountCode__c,
target.Fiscal = source.Fiscal,
target.FiscalQuarter = source.FiscalQuarter,
target.FiscalYear = source.FiscalYear,
target.ForecastCategory = source.ForecastCategory,
target.ForecastCategoryName = source.ForecastCategoryName,
target.GeoJSON__c = source.GeoJSON__c,
target.Go_Live_Month__c = source.Go_Live_Month__c,
target.Grand_Total__c = source.Grand_Total__c,
target.Hardware_Access__c = source.Hardware_Access__c,
target.HasOpenActivity = source.HasOpenActivity,
target.HasOpportunityLineItem = source.HasOpportunityLineItem,
target.HasOverdueTask = source.HasOverdueTask,
target.Inbound_Source__c = source.Inbound_Source__c,
target.Individual_Subscription__c = source.Individual_Subscription__c,
target.Invoice_Due_Date__c = source.Invoice_Due_Date__c,
target.Invoice_Fully_Paid_for_QuotaPath__c = source.Invoice_Fully_Paid_for_QuotaPath__c,
target.Invoicing_Method__c = source.Invoicing_Method__c,
target.Invoicing_System__c = source.Invoicing_System__c,
target.IsClosed = source.IsClosed,
target.IsDeleted = source.IsDeleted,
target.IsExcludedFromTerritory2Filter = source.IsExcludedFromTerritory2Filter,
target.IsWon = source.IsWon,
target.Is_Current_Active_Opportunity__c = source.Is_Current_Active_Opportunity__c,
target.Is_Most_Recent_Won_Numeric__c = source.Is_Most_Recent_Won_Numeric__c,
target.LastActivityDate = source.LastActivityDate,
target.LastAmountChangedHistoryId = source.LastAmountChangedHistoryId,
target.LastCloseDateChangedHistoryId = source.LastCloseDateChangedHistoryId,
target.LastModifiedById = source.LastModifiedById,
target.LastModifiedDate = source.LastModifiedDate,
target.LastStageChangeDate = source.LastStageChangeDate,
target.Last_Contract_End_Date__c = source.Last_Contract_End_Date__c,
target.Last_Won_Close_Month__c = source.Last_Won_Close_Month__c,
target.LeadSource = source.LeadSource,
target.Loss_Reason__c = source.Loss_Reason__c,
target.Manual_Invoicing_Required__c = source.Manual_Invoicing_Required__c,
target.Marketing_Notes__c = source.Marketing_Notes__c,
target.Marketing_Resources__c = source.Marketing_Resources__c,
target.Monthly_Invoicing__c = source.Monthly_Invoicing__c,
target.Monthly_Revenue__c = source.Monthly_Revenue__c,
target.Months_Active__c = source.Months_Active__c,
target.Name = source.Name,
target.NextStep = source.NextStep,
target.No_of_Minutes__c = source.No_of_Minutes__c,
target.OT_Pilot__c = source.OT_Pilot__c,
target.Offer_Expiration__c = source.Offer_Expiration__c,
target.One_Time_Event__c = source.One_Time_Event__c,
target.Opp_Remaining_Contract__c = source.Opp_Remaining_Contract__c,
target.Option_to_Renew_Term__c = source.Option_to_Renew_Term__c,
target.Outbound_Method__c = source.Outbound_Method__c,
target.OwnerId = source.OwnerId,
target.PON__c = source.PON__c,
target.PR_Marketing_Launch__c = source.PR_Marketing_Launch__c,
target.Payment_Schedule__c = source.Payment_Schedule__c,
target.Payment_Term_Days_Conversion_to_Text__c = source.Payment_Term_Days_Conversion_to_Text__c,
target.Payment_Term_Days__c = source.Payment_Term_Days__c,
target.Power_of_1__c = source.Power_of_1__c,
target.Pre_Sales_Notes__c = source.Pre_Sales_Notes__c,
target.Prepared_By__c = source.Prepared_By__c,
target.Price_per_Location__c = source.Price_per_Location__c,
target.Probability = source.Probability,
target.Product_Access__c = source.Product_Access__c,
target.Projected_Start_Date__c = source.Projected_Start_Date__c,
target.Provisioning_Notes__c = source.Provisioning_Notes__c,
target.Public_Partnership_Numeric__c = source.Public_Partnership_Numeric__c,
target.Public_Partnership__c = source.Public_Partnership__c,
target.QC_Owner__c = source.QC_Owner__c,
target.ROI_Analysis_Completed__c = source.ROI_Analysis_Completed__c,
target.RR_Adj_Start_Date_Month_2021__c = source.RR_Adj_Start_Date_Month_2021__c,
target.RR_Adjusted_Contract_Length_2020__c = source.RR_Adjusted_Contract_Length_2020__c,
target.RR_Adjusted_Quarter__c = source.RR_Adjusted_Quarter__c,
target.RR_Is_Adjusted_Start_Date_2021__c = source.RR_Is_Adjusted_Start_Date_2021__c,
target.Recognized_Revenue_Copy__c = source.Recognized_Revenue_Copy__c,
target.Recognized_Revenue__c = source.Recognized_Revenue__c,
target.RecordTypeId = source.RecordTypeId,
target.Remaining_Revenue__c = source.Remaining_Revenue__c,
target.Renewal_Type__c = source.Renewal_Type__c,
target.Renewed__c = source.Renewed__c,
target.SME__c = source.SME__c,
target.Seller__c = source.Seller__c,
target.StageName = source.StageName,
target.Start_Date_and_Time__c = source.Start_Date_and_Time__c,
target.Subtotal__c = source.Subtotal__c,
target.SystemModstamp = source.SystemModstamp,
target.Template_Id__c = source.Template_Id__c,
target.Term_Length__c = source.Term_Length__c,
target.Trial_Month__c = source.Trial_Month__c,
target.True_Up_Amount__c = source.True_Up_Amount__c,
target.Type = source.Type,
target.Type_Numeric__c = source.Type_Numeric__c,
target.UsageCost_per_minute__c = source.UsageCost_per_minute__c,
target.Weighted_Amount__c = source.Weighted_Amount__c,
target.Weighted_Locations__c = source.Weighted_Locations__c,
target.Won_Amount__c = source.Won_Amount__c,
target.breadwinner_qbo__Total_Amount_Due__c = source.breadwinner_qbo__Total_Amount_Due__c,
target.breadwinner_qbo__Total_Amount_Invoiced__c = source.breadwinner_qbo__Total_Amount_Invoiced__c,
target.breadwinner_qbo__Total_Amount_Overdue__c = source.breadwinner_qbo__Total_Amount_Overdue__c,
target.breadwinner_qbo__Total_Amount_Paid__c = source.breadwinner_qbo__Total_Amount_Paid__c,
target.Exclude_from_Usage_Based_Billing__c = source.Exclude_from_Usage_Based_Billing__c,
target.Estimated_Payment_Date__c = source.Estimated_Payment_Date__c,
target.Credit_Memo_Amount__c = source.Credit_Memo_Amount__c
WHEN NOT MATCHED THEN
  INSERT ROW