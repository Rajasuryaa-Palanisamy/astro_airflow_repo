 MERGE `searce-dna-ps1-delivery.salesforce_curated.user` AS target
USING `searce-dna-ps1-delivery.salesforce_raw.raw_user` AS source
ON target.id = source.id
WHEN MATCHED AND source.SystemModstamp > target.SystemModstamp THEN
  UPDATE SET
target.Id	= source.Id,
target.Username	= source.Username,
target.LastName	= source.LastName,
target.FirstName	= source.FirstName,
target.MiddleName	= source.MiddleName,
target.Suffix	= source.Suffix,
target.Name	= source.Name,
target.CompanyName	= source.CompanyName,
target.Division	= source.Division,
target.Department	= source.Department,
target.Title	= source.Title,
target.Street	= source.Street,
target.City	= source.City,
target.State	= source.State,
target.PostalCode	= source.PostalCode,
target.Country	= source.Country,
target.Latitude	= source.Latitude,
target.Longitude	= source.Longitude,
target.GeocodeAccuracy	= source.GeocodeAccuracy,
target.Address	= source.Address,
target.Email	= source.Email,
target.EmailPreferencesAutoBcc	= source.EmailPreferencesAutoBcc,
target.EmailPreferencesAutoBccStayInTouch	= source.EmailPreferencesAutoBccStayInTouch,
target.EmailPreferencesStayInTouchReminder	= source.EmailPreferencesStayInTouchReminder,
target.SenderEmail	= source.SenderEmail,
target.SenderName	= source.SenderName,
target.Signature	= source.Signature,
target.StayInTouchSubject	= source.StayInTouchSubject,
target.StayInTouchSignature	= source.StayInTouchSignature,
target.StayInTouchNote	= source.StayInTouchNote,
target.Phone	= source.Phone,
target.Fax	= source.Fax,
target.MobilePhone	= source.MobilePhone,
target.Alias	= source.Alias,
target.CommunityNickname	= source.CommunityNickname,
target.BadgeText	= source.BadgeText,
target.IsActive	= source.IsActive,
target.TimeZoneSidKey	= source.TimeZoneSidKey,
target.LocaleSidKey	= source.LocaleSidKey,
target.ReceivesInfoEmails	= source.ReceivesInfoEmails,
target.ReceivesAdminInfoEmails	= source.ReceivesAdminInfoEmails,
target.EmailEncodingKey	= source.EmailEncodingKey,
target.UserType	= source.UserType,
target.LanguageLocaleKey	= source.LanguageLocaleKey,
target.EmployeeNumber	= source.EmployeeNumber,
target.DelegatedApproverId	= source.DelegatedApproverId,
target.ManagerId	= source.ManagerId,
target.LastLoginDate	= source.LastLoginDate,
target.CreatedDate	= source.CreatedDate,
target.CreatedById	= source.CreatedById,
target.LastModifiedDate	= source.LastModifiedDate,
target.LastModifiedById	= source.LastModifiedById,
target.SystemModstamp	= source.SystemModstamp,
target.OfflineTrialExpirationDate	= source.OfflineTrialExpirationDate,
target.OfflinePdaTrialExpirationDate	= source.OfflinePdaTrialExpirationDate,
target.UserPermissionsMarketingUser	= source.UserPermissionsMarketingUser,
target.UserPermissionsOfflineUser	= source.UserPermissionsOfflineUser,
target.UserPermissionsAvantgoUser	= source.UserPermissionsAvantgoUser,
target.UserPermissionsCallCenterAutoLogin	= source.UserPermissionsCallCenterAutoLogin,
target.UserPermissionsSFContentUser	= source.UserPermissionsSFContentUser,
target.UserPermissionsKnowledgeUser	= source.UserPermissionsKnowledgeUser,
target.UserPermissionsInteractionUser	= source.UserPermissionsInteractionUser,
target.UserPermissionsSupportUser	= source.UserPermissionsSupportUser,
target.ForecastEnabled	= source.ForecastEnabled,
target.UserPreferencesActivityRemindersPopup	= source.UserPreferencesActivityRemindersPopup,
target.UserPreferencesEventRemindersCheckboxDefault	= source.UserPreferencesEventRemindersCheckboxDefault,
target.UserPreferencesTaskRemindersCheckboxDefault	= source.UserPreferencesTaskRemindersCheckboxDefault,
target.UserPreferencesReminderSoundOff	= source.UserPreferencesReminderSoundOff,
target.UserPreferencesDisableAllFeedsEmail	= source.UserPreferencesDisableAllFeedsEmail,
target.UserPreferencesDisableFollowersEmail	= source.UserPreferencesDisableFollowersEmail,
target.UserPreferencesDisableProfilePostEmail	= source.UserPreferencesDisableProfilePostEmail,
target.UserPreferencesDisableChangeCommentEmail	= source.UserPreferencesDisableChangeCommentEmail,
target.UserPreferencesDisableLaterCommentEmail	= source.UserPreferencesDisableLaterCommentEmail,
target.UserPreferencesDisProfPostCommentEmail	= source.UserPreferencesDisProfPostCommentEmail,
target.UserPreferencesContentNoEmail	= source.UserPreferencesContentNoEmail,
target.UserPreferencesContentEmailAsAndWhen	= source.UserPreferencesContentEmailAsAndWhen,
target.UserPreferencesHideCSNGetChatterMobileTask	= source.UserPreferencesHideCSNGetChatterMobileTask,
target.UserPreferencesDisableMentionsPostEmail	= source.UserPreferencesDisableMentionsPostEmail,
target.UserPreferencesDisMentionsCommentEmail	= source.UserPreferencesDisMentionsCommentEmail,
target.UserPreferencesHideCSNDesktopTask	= source.UserPreferencesHideCSNDesktopTask,
target.UserPreferencesHideChatterOnboardingSplash	= source.UserPreferencesHideChatterOnboardingSplash,
target.UserPreferencesHideSecondChatterOnboardingSplash	= source.UserPreferencesHideSecondChatterOnboardingSplash,
target.UserPreferencesDisCommentAfterLikeEmail	= source.UserPreferencesDisCommentAfterLikeEmail,
target.UserPreferencesDisableLikeEmail	= source.UserPreferencesDisableLikeEmail,
target.UserPreferencesSortFeedByComment	= source.UserPreferencesSortFeedByComment,
target.UserPreferencesDisableMessageEmail	= source.UserPreferencesDisableMessageEmail,
target.UserPreferencesDisableBookmarkEmail	= source.UserPreferencesDisableBookmarkEmail,
target.UserPreferencesDisableSharePostEmail	= source.UserPreferencesDisableSharePostEmail,
target.UserPreferencesEnableAutoSubForFeeds	= source.UserPreferencesEnableAutoSubForFeeds,
target.UserPreferencesDisableFileShareNotificationsForApi	= source.UserPreferencesDisableFileShareNotificationsForApi,
target.UserPreferencesShowTitleToExternalUsers	= source.UserPreferencesShowTitleToExternalUsers,
target.UserPreferencesShowManagerToExternalUsers	= source.UserPreferencesShowManagerToExternalUsers,
target.UserPreferencesShowEmailToExternalUsers	= source.UserPreferencesShowEmailToExternalUsers,
target.UserPreferencesShowWorkPhoneToExternalUsers	= source.UserPreferencesShowWorkPhoneToExternalUsers,
target.UserPreferencesShowMobilePhoneToExternalUsers	= source.UserPreferencesShowMobilePhoneToExternalUsers,
target.UserPreferencesShowFaxToExternalUsers	= source.UserPreferencesShowFaxToExternalUsers,
target.UserPreferencesShowStreetAddressToExternalUsers	= source.UserPreferencesShowStreetAddressToExternalUsers,
target.UserPreferencesShowCityToExternalUsers	= source.UserPreferencesShowCityToExternalUsers,
target.UserPreferencesShowStateToExternalUsers	= source.UserPreferencesShowStateToExternalUsers,
target.UserPreferencesShowPostalCodeToExternalUsers	= source.UserPreferencesShowPostalCodeToExternalUsers,
target.UserPreferencesShowCountryToExternalUsers	= source.UserPreferencesShowCountryToExternalUsers,
target.UserPreferencesShowProfilePicToGuestUsers	= source.UserPreferencesShowProfilePicToGuestUsers,
target.UserPreferencesShowTitleToGuestUsers	= source.UserPreferencesShowTitleToGuestUsers,
target.UserPreferencesShowCityToGuestUsers	= source.UserPreferencesShowCityToGuestUsers,
target.UserPreferencesShowStateToGuestUsers	= source.UserPreferencesShowStateToGuestUsers,
target.UserPreferencesShowPostalCodeToGuestUsers	= source.UserPreferencesShowPostalCodeToGuestUsers,
target.UserPreferencesShowCountryToGuestUsers	= source.UserPreferencesShowCountryToGuestUsers,
target.UserPreferencesShowForecastingChangeSignals	= source.UserPreferencesShowForecastingChangeSignals,
target.UserPreferencesLiveAgentMiawSetupDeflection	= source.UserPreferencesLiveAgentMiawSetupDeflection,
target.UserPreferencesHideS1BrowserUI	= source.UserPreferencesHideS1BrowserUI,
target.UserPreferencesDisableEndorsementEmail	= source.UserPreferencesDisableEndorsementEmail,
target.UserPreferencesPathAssistantCollapsed	= source.UserPreferencesPathAssistantCollapsed,
target.UserPreferencesCacheDiagnostics	= source.UserPreferencesCacheDiagnostics,
target.UserPreferencesShowEmailToGuestUsers	= source.UserPreferencesShowEmailToGuestUsers,
target.UserPreferencesShowManagerToGuestUsers	= source.UserPreferencesShowManagerToGuestUsers,
target.UserPreferencesShowWorkPhoneToGuestUsers	= source.UserPreferencesShowWorkPhoneToGuestUsers,
target.UserPreferencesShowMobilePhoneToGuestUsers	= source.UserPreferencesShowMobilePhoneToGuestUsers,
target.UserPreferencesShowFaxToGuestUsers	= source.UserPreferencesShowFaxToGuestUsers,
target.UserPreferencesShowStreetAddressToGuestUsers	= source.UserPreferencesShowStreetAddressToGuestUsers,
target.UserPreferencesLightningExperiencePreferred	= source.UserPreferencesLightningExperiencePreferred,
target.UserPreferencesHideEndUserOnboardingAssistantModal	= source.UserPreferencesHideEndUserOnboardingAssistantModal,
target.UserPreferencesHideLightningMigrationModal	= source.UserPreferencesHideLightningMigrationModal,
target.UserPreferencesHideSfxWelcomeMat	= source.UserPreferencesHideSfxWelcomeMat,
target.UserPreferencesHideBiggerPhotoCallout	= source.UserPreferencesHideBiggerPhotoCallout,
target.UserPreferencesGlobalNavBarWTShown	= source.UserPreferencesGlobalNavBarWTShown,
target.UserPreferencesGlobalNavGridMenuWTShown	= source.UserPreferencesGlobalNavGridMenuWTShown,
target.UserPreferencesCreateLEXAppsWTShown	= source.UserPreferencesCreateLEXAppsWTShown,
target.UserPreferencesFavoritesWTShown	= source.UserPreferencesFavoritesWTShown,
target.UserPreferencesRecordHomeSectionCollapseWTShown	= source.UserPreferencesRecordHomeSectionCollapseWTShown,
target.UserPreferencesRecordHomeReservedWTShown	= source.UserPreferencesRecordHomeReservedWTShown,
target.UserPreferencesFavoritesShowTopFavorites	= source.UserPreferencesFavoritesShowTopFavorites,
target.UserPreferencesExcludeMailAppAttachments	= source.UserPreferencesExcludeMailAppAttachments,
target.UserPreferencesSuppressTaskSFXReminders	= source.UserPreferencesSuppressTaskSFXReminders,
target.UserPreferencesSuppressEventSFXReminders	= source.UserPreferencesSuppressEventSFXReminders,
target.UserPreferencesPreviewCustomTheme	= source.UserPreferencesPreviewCustomTheme,
target.UserPreferencesHasCelebrationBadge	= source.UserPreferencesHasCelebrationBadge,
target.UserPreferencesUserDebugModePref	= source.UserPreferencesUserDebugModePref,
target.UserPreferencesSRHOverrideActivities	= source.UserPreferencesSRHOverrideActivities,
target.UserPreferencesNewLightningReportRunPageEnabled	= source.UserPreferencesNewLightningReportRunPageEnabled,
target.UserPreferencesReverseOpenActivitiesView	= source.UserPreferencesReverseOpenActivitiesView,
target.UserPreferencesHasSentWarningEmail	= source.UserPreferencesHasSentWarningEmail,
target.UserPreferencesHasSentWarningEmail238	= source.UserPreferencesHasSentWarningEmail238,
target.UserPreferencesHasSentWarningEmail240	= source.UserPreferencesHasSentWarningEmail240,
target.UserPreferencesHideBrowseProductRedirectConfirmation	= source.UserPreferencesHideBrowseProductRedirectConfirmation,
target.UserPreferencesHideOnlineSalesAppWelcomeMat	= source.UserPreferencesHideOnlineSalesAppWelcomeMat,
target.UserPreferencesShowForecastingRoundedAmounts	= source.UserPreferencesShowForecastingRoundedAmounts,
target.ContactId	= source.ContactId,
target.AccountId	= source.AccountId,
target.CallCenterId	= source.CallCenterId,
target.Extension	= source.Extension,
target.PortalRole	= source.PortalRole,
target.IsPortalEnabled	= source.IsPortalEnabled,
target.FederationIdentifier	= source.FederationIdentifier,
target.AboutMe	= source.AboutMe,
target.FullPhotoUrl	= source.FullPhotoUrl,
target.SmallPhotoUrl	= source.SmallPhotoUrl,
target.IsExtIndicatorVisible	= source.IsExtIndicatorVisible,
target.OutOfOfficeMessage	= source.OutOfOfficeMessage,
target.MediumPhotoUrl	= source.MediumPhotoUrl,
target.DigestFrequency	= source.DigestFrequency,
target.DefaultGroupNotificationFrequency	= source.DefaultGroupNotificationFrequency,
target.LastViewedDate	= source.LastViewedDate,
target.LastReferencedDate	= source.LastReferencedDate,
target.BannerPhotoUrl	= source.BannerPhotoUrl,
target.SmallBannerPhotoUrl	= source.SmallBannerPhotoUrl,
target.MediumBannerPhotoUrl	= source.MediumBannerPhotoUrl,
target.IsProfilePhotoActive	= source.IsProfilePhotoActive,
target.IndividualId	= source.IndividualId,
target.dsgen__DocuSign_Invitation_Date__c	= source.dsgen__DocuSign_Invitation_Date__c,
target.dsgen__Docusign_Admin__c	= source.dsgen__Docusign_Admin__c,
target.dsgen__Docusign_Invite_Id__c	= source.dsgen__Docusign_Invite_Id__c,
target.dsgen__Docusign_Status__c	= source.dsgen__Docusign_Status__c,
target.dsgen__Docusign_User_Id__c	= source.dsgen__Docusign_User_Id__c,
target.amazonconnect__Amazon_Connect_Username__c	= source.amazonconnect__Amazon_Connect_Username__c,
target.TwilioSF__Twilio_Personal_Number_Is_Valid__c	= source.TwilioSF__Twilio_Personal_Number_Is_Valid__c,
target.TwilioSF__Twilio_Personal_Number__c	= source.TwilioSF__Twilio_Personal_Number__c,
target.et4ae5__Default_ET_Page__c	= source.et4ae5__Default_ET_Page__c,
target.et4ae5__Default_MID__c	= source.et4ae5__Default_MID__c,
target.et4ae5__ExactTargetForAppExchangeAdmin__c	= source.et4ae5__ExactTargetForAppExchangeAdmin__c,
target.et4ae5__ExactTargetForAppExchangeUser__c	= source.et4ae5__ExactTargetForAppExchangeUser__c,
target.et4ae5__ExactTargetUsername__c	= source.et4ae5__ExactTargetUsername__c,
target.et4ae5__ExactTarget_OAuth_Token__c	= source.et4ae5__ExactTarget_OAuth_Token__c,
target.et4ae5__ValidExactTargetAdmin__c	= source.et4ae5__ValidExactTargetAdmin__c,
target.et4ae5__ValidExactTargetUser__c	= source.et4ae5__ValidExactTargetUser__c
WHEN NOT MATCHED THEN
  INSERT ROW